<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="theme-color" content="#2563eb" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>M2H Admin Panel</title>

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Custom Admin Styles -->
  <link rel="stylesheet" href="/admin.css">
</head>

<body class="bg-gray-900 text-white overflow-hidden">

  <!-- LOGIN SCREEN -->
  <div id="login-screen" class="fixed inset-0 bg-gray-900 flex flex-col items-center justify-center">
    <div class="glass-card p-8 rounded-xl w-80 text-center">
      <h1 class="text-2xl font-bold mb-6">Admin Login</h1>

      <input id="admin-key-input" 
             type="password" 
             placeholder="Enter Admin Key" 
             class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 outline-none">

      <button onclick="AdminAPI.login()" 
              class="w-full mt-4 p-3 rounded-lg bg-blue-600 hover:bg-blue-700 transition">
        Login
      </button>

      <p id="login-error" class="hidden mt-3 text-red-400 text-sm">
        Invalid Admin Key
      </p>
    </div>
  </div>


  <!-- MAIN PANEL -->
  <div id="admin-panel" class="hidden flex h-screen">

    <!-- SIDEBAR -->
    <aside id="sidebar" class="w-64 bg-gray-950 border-r border-gray-800 flex flex-col">

      <div class="p-5 border-b border-gray-800 flex items-center space-x-3">
        <span class="material-icons-round text-blue-500 text-3xl">admin_panel_settings</span>
        <h2 class="text-xl font-bold">M2H Admin</h2>
      </div>

      <nav class="flex-1 overflow-y-auto">
        <ul class="p-4 space-y-1">
          <li><button onclick="AdminUI.switchTab('dashboard')" class="nav-item active"><span class="material-icons-round">dashboard</span>Dashboard</button></li>
          <li><button onclick="AdminUI.switchTab('videos')" class="nav-item"><span class="material-icons-round">movie</span>Videos</button></li>
          <li><button onclick="AdminUI.switchTab('requests')" class="nav-item"><span class="material-icons-round">list</span>Requests</button></li>
          <li><button onclick="AdminUI.switchTab('bans')" class="nav-item"><span class="material-icons-round">block</span>Ban System</button></li>
          <li><button onclick="AdminUI.switchTab('settings')" class="nav-item"><span class="material-icons-round">settings</span>Settings</button></li>
          <li><button onclick="AdminUI.switchTab('logs')" class="nav-item"><span class="material-icons-round">bug_report</span>Logs</button></li>
        </ul>
      </nav>

      <div class="p-4 border-t border-gray-800">
        <button onclick="AdminAPI.logout()" 
                class="w-full p-3 rounded bg-red-600 hover:bg-red-700 flex items-center justify-center space-x-2">
          <span class="material-icons-round">logout</span><span>Logout</span>
        </button>
      </div>

    </aside>


    <!-- MAIN CONTENT -->
    <main class="flex-1 overflow-y-auto">
      <header class="p-4 border-b border-gray-800 flex items-center justify-between backdrop-blur bg-gray-900/60">
        <h1 id="page-title" class="text-2xl font-bold">Dashboard</h1>
        <button onclick="AdminUI.toggleSidebar()" 
                class="md:hidden p-2 rounded bg-gray-800">
          <span class="material-icons-round">menu</span>
        </button>
      </header>

      <!-- Dashboard -->
      <section id="tab-dashboard" class="tab-page">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 p-6">

          <div class="dashboard-card">
            <span class="material-icons-round text-blue-400">trending_up</span>
            <h3>Total Requests</h3>
            <p id="stat-total-requests" class="stat-number">0</p>
          </div>

          <div class="dashboard-card">
            <span class="material-icons-round text-green-400">movie_filter</span>
            <h3>Total Videos</h3>
            <p id="stat-total-videos" class="stat-number">0</p>
          </div>

          <div class="dashboard-card">
            <span class="material-icons-round text-purple-400">public</span>
            <h3>Unique IPs</h3>
            <p id="stat-unique-ips" class="stat-number">0</p>
          </div>

        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 p-6">

          <div class="glass-card p-4">
            <h3 class="text-xl font-semibold mb-2">Device Analytics</h3>
            <canvas id="chart-devices"></canvas>
          </div>

          <div class="glass-card p-4">
            <h3 class="text-xl font-semibold mb-2">Requests (Last 24h)</h3>
            <canvas id="chart-requests"></canvas>
          </div>

        </div>
      </section>


      <!-- Videos -->
      <section id="tab-videos" class="tab-page hidden p-6">
        <h2 class="text-2xl font-bold mb-4">Top Downloaded Videos</h2>
        <div id="videos-list" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"></div>
      </section>


      <!-- Requests -->
      <section id="tab-requests" class="tab-page hidden p-6">
        <h2 class="text-2xl font-bold mb-4">Recent Requests</h2>

        <table class="w-full text-left border-collapse admin-table">
          <thead>
            <tr>
              <th>IP</th>
              <th>Device</th>
              <th>Browser</th>
              <th>Platform</th>
              <th>Endpoint</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody id="requests-table-body"></tbody>
        </table>
      </section>


      <!-- Ban System -->
      <section id="tab-bans" class="tab-page hidden p-6">
        <h2 class="text-2xl font-bold mb-4">Ban System</h2>

        <div class="glass-card p-4 w-full md:w-1/2">
          <h3 class="text-lg font-semibold mb-2">Ban IP Address</h3>

          <input id="ban-ip-input" 
                 type="text" 
                 placeholder="Enter IP Address"
                 class="w-full p-3 rounded bg-gray-800 border border-gray-700 outline-none">

          <button onclick="AdminAPI.banIP()" 
                  class="w-full mt-3 p-3 rounded bg-red-600 hover:bg-red-700">
            Ban IP
          </button>

          <p id="ban-status" class="mt-3 text-green-400 hidden">Banned Successfully</p>
        </div>
      </section>


      <!-- Settings -->
      <section id="tab-settings" class="tab-page hidden p-6">

        <h2 class="text-2xl font-bold mb-4">Admin Settings</h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

          <div class="glass-card p-4">
            <h3 class="text-xl font-semibold mb-3">Theme</h3>
            <button onclick="AdminUI.toggleTheme()" class="p-3 rounded bg-blue-600 hover:bg-blue-700">
              Toggle Dark / Light Mode
            </button>
          </div>

          <div class="glass-card p-4">
            <h3 class="text-xl font-semibold mb-3">Danger Zone</h3>

            <button onclick="AdminAPI.resetStats()" class="p-3 rounded bg-red-600 hover:bg-red-700 w-full">
              Reset Statistics
            </button>

            <button onclick="AdminAPI.clearRequests()" class="p-3 mt-3 rounded bg-red-700 hover:bg-red-800 w-full">
              Clear All Requests
            </button>

            <button onclick="AdminAPI.clearVideos()" class="p-3 mt-3 rounded bg-red-800 hover:bg-red-900 w-full">
              Clear All Videos
            </button>
          </div>

        </div>
      </section>


      <!-- Logs -->
      <section id="tab-logs" class="tab-page hidden p-6">
        <h2 class="text-2xl font-bold">System Logs</h2>
        <pre id="logs-output" class="glass-card p-4 mt-4 h-[400px] overflow-y-auto text-sm"></pre>
      </section>

    </main>
  </div>

  <!-- SCRIPTS â€” correct order is IMPORTANT -->
  <!-- <script src="/admin-api.js"></script> -->
  <script src="/admin.js"></script>

</body>
</html>
